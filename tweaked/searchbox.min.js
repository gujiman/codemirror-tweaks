(function(a){if(typeof exports==="object"&&typeof module==="object"){a(require("../../lib/codemirror"))}else{if(typeof define==="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(b){var d=new Object();b.defineOption("searchbox",false,function(i){i.addKeyMap({"Ctrl-F":function(){g(i)},Esc:function(){var j=i.getOption("parentID");if(d[j]&&d[j].isVisible()){d[j].hide();if(typeof event!=="undefined"){event.stopPropagation()}}return false},"Cmd-F":function(){g(i)}})});function g(i){if(i.getOption("searchbox")==true){var j=i.getOption("parentID");if($("#"+j).children(".ace_search").length==0){if(d[j]){delete d[j]}d[j]=new h(i)}d[j].show()}}function h(i){var k=this;o();function j(p){k.searchBox=p.querySelector(".ace_search_form");k.replaceBox=p.querySelector(".ace_replace_form");k.searchOptions=p.querySelector(".ace_search_options");k.regExpOption=p.querySelector("[action=toggleRegexpMode]");k.caseSensitiveOption=p.querySelector("[action=toggleCaseSensitive]");k.wholeWordOption=p.querySelector("[action=toggleWholeWords]");k.searchInput=k.searchBox.querySelector(".ace_search_field");k.replaceInput=k.replaceBox.querySelector(".ace_search_field");k.close=p.querySelector(".close")}function o(){var p=k.element=l();j(p);m();p.addEventListener("mousedown",function(q){setTimeout(function(){k.activeInput.focus()},0);q.stopPropagation()});p.addEventListener("click",function(s){var q=s.target||s.srcElement;var r=q.getAttribute("action");if(r&&k[r]){k[r]()}else{if(k.commands[r]){k.commands[r]()}}s.stopPropagation()});k.searchInput.addEventListener("input",function(){k.$onChange.schedule(20)});k.searchInput.addEventListener("focus",function(){k.activeInput=k.searchInput});k.replaceInput.addEventListener("focus",function(){k.activeInput=k.replaceInput});k.close.addEventListener("click",function(q){setTimeout(function(){k.hide()});q.stopPropagation()});k.$onChange=f(function(){k.find(false,false)})}function m(){var q=k,p={"Ctrl-F|Cmd-F|Ctrl-H|Command-Alt-F":function(){q.searchInput.focus()},"Ctrl-G|Cmd-G":function(){q.findNext()},"Ctrl-Shift-G|Cmd-Shift-G":function(){q.findPrev()},Esc:function(){setTimeout(function(){q.hide()})},Enter:function(){if(q.activeInput===q.replaceInput){q.replace()}q.findNext()},"Shift-Enter":function(){if(q.activeInput===q.replaceInput){q.replace()}q.findPrev()},Tab:function(){if(k.activeInput===k.replaceInput){k.searchInput.focus()}else{k.replaceInput.focus()}}};k.element.addEventListener("keydown",function(r){Object.keys(p).some(function(s){var t=e(s,r);if(t){r.stopPropagation();r.preventDefault();p[s](r)}return t})})}this.commands={toggleRegexpMode:function(){k.regExpOption.checked=!k.regExpOption.checked;k.$syncOptions()},toggleCaseSensitive:function(){k.caseSensitiveOption.checked=!k.caseSensitiveOption.checked;k.$syncOptions()},toggleWholeWords:function(){k.wholeWordOption.checked=!k.wholeWordOption.checked;k.$syncOptions()}};this.$syncOptions=function(){c(this.regExpOption,"checked",this.regExpOption.checked);c(this.wholeWordOption,"checked",this.wholeWordOption.checked);c(this.caseSensitiveOption,"checked",this.caseSensitiveOption.checked);this.find(false,false)};this.find=function(s,p){var r=this.searchInput.value,q={skipCurrent:s,backwards:p,regExp:this.regExpOption.checked,caseSensitive:this.caseSensitiveOption.checked,wholeWord:this.wholeWordOption.checked};n(r,q,function(t){var u=t.matches(false,t.from());i.setSelection(u.from,u.to)})};function n(B,F,E){var t,C,p,x,s,w,D,v,r=B,q=F,u=true,z=q.caseSensitive,y=q.regExp,A=q.wholeWord;if(y||A){if(F.wholeWord){r="\\b"+r+"\\b"}r=RegExp(r)}if(q.backwards){v=q.skipCurrent?"from":"to"}else{v=q.skipCurrent?"to":"from"}D=i.getCursor(v);p=i.getSearchCursor(r,D,!z);x=p.findNext.bind(p),s=p.findPrevious.bind(p),w=p.matches.bind(p);if(q.backwards&&!s()){u=x();if(u){i.setCursor(i.doc.size-1,0);n(B,F,E);t=true}}else{if(!q.backwards&&!x()){u=s();if(u){i.setCursor(0,0);n(B,F,E);t=true}}}C=!u&&k.searchInput.value;c(k.searchBox,"ace_nomatch",C);if(!t&&u){E(p)}if(B==""){i.setCursor(i.getCursor())}}this.findNext=function(){this.find(true,false)};this.findPrev=function(){this.find(true,true)};this.replace=function(){var q=i.getOption("readOnly"),p=!!i.getSelection();if(!q&&p){i.replaceSelection(this.replaceInput.value,"start")}};this.replaceAndFindNext=function(){var p=i.getOption("readOnly");if(!p){this.replace();this.findNext()}};this.replaceAll=function(){var q,r,t=this.searchInput.value,s=this.replaceInput.value,p=RegExp(t,"g");if(!i.getOption("readOnly")){r=i.getCursor();q=i.getValue();q=q.replace(p,s);i.setValue(q);i.setCursor(r)}};this.hide=function(){this.element.style.display="none";i.focus();var p=i.getOption("parentID");$("#"+p).children(".CodeMirror").css("height","100%")};this.isVisible=function(){var p=this.element.style.display==="";return p};this.show=function(r){this.element.style.display="";if(r){this.searchInput.value=r}this.searchInput.focus();this.searchInput.select();var s=i.getOption("parentID");var p=$("#"+s).children(".CodeMirror");var q=$("#"+s).children(".ace_search");p.css("height",p.outerHeight(true)-q.outerHeight(true))};this.isFocused=function(){var p=document.activeElement;return p===this.searchInput||p===this.replaceInput};function l(){var t=i.getOption("parentID");var r,q=document.getElementById(t),s=document.createElement("div"),p=['<div class="serach_id_'+t+' ace_search form-inline alert alert-success alert-dismissible" role="alert">','<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>','<div class="ace_search_form">','<input class="ace_search_field" placeholder="Search for" spellcheck="false"></input>','<button type="button" action="findNext" class="btn btn-link">Next</button>','<button type="button" action="findPrev" class="btn btn-link">Previous</button>',"</div>",'<div class="ace_replace_form">','<input class="ace_search_field" placeholder="Replace with" spellcheck="false"></input>','<button type="button" action="replaceAndFindNext" class="btn btn-link">Replace</button>','<button type="button" action="replaceAll" class="btn btn-link">All</button>',"</div>",'<div class="ace_search_options form-group form-group-sm">','<span action="toggleRegexpMode" class="ace_button" title="RegExp Search" data-toggle="tooltip" data-placement="top" data-trigger="hover">.*</span>','<span action="toggleCaseSensitive" class="ace_button" title="Case Sensitive Search" data-toggle="tooltip" data-placement="top" data-trigger="hover">Aa</span>','<span action="toggleWholeWords" class="ace_button" title="Whole Word Search" data-toggle="tooltip" data-placement="top" data-trigger="hover">\\b</span>',"</div>","</div>"].join("");s.innerHTML=p;r=s.firstChild;q.appendChild(r);if(i.getOption("readOnly")==true){$("#"+t).children(".ace_search").find(".ace_replace_form").hide()}$(".serach_id_"+t).find('[data-toggle="tooltip"]').tooltip({container:"body"});return r}}function c(j,i,l){var k=j.classList;k[l?"add":"remove"](i)}function f(k,j){var m,l=function(){m=null;k()},i=function(n){if(!m){m=setTimeout(l,n||j)}};i.delay=function(n){m&&clearTimeout(m);m=setTimeout(l,n||j)};i.schedule=i;i.call=function(){this.cancel();k()};i.cancel=function(){m&&clearTimeout(m);m=null};i.isPending=function(){return m};return i}function e(l,k){var j,i={BACKSPACE:8,TAB:9,ENTER:13,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,UP:38,DOWN:40,INSERT:45,DELETE:46,INSERT_MAC:96,ASTERISK:106,PLUS:107,MINUS:109,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,SLASH:191,TRA:192,BACKSLASH:220};a(l,k);j=l.split("|").some(function(n){var m;m=n.split("-").some(function(p){var o;switch(p){case"Ctrl":o=k.ctrlKey;break;case"Shift":o=k.shiftKey;break;case"Alt":o=k.altKey;break;case"Cmd":o=k.metaKey;break;default:if(p.length===1){o=k.keyCode===p.charCodeAt(0)}else{Object.keys(i).some(function(r){var q=p.toUpperCase();if(q===r){o=k.keyCode===i[r]}})}break}return !o});return !m});return j}function a(j,i){if(typeof j!=="string"){throw (Error("str should be string!"))}if(typeof i!=="object"){throw (Error("event should be object!"))}}});